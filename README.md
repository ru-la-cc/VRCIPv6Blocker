# VRCIPv6Blocker

### 以降は100%AIの文章でなので悪しからず... ###

VRChatの起動時にIPv6を一時的にブロックし、VRChat終了時に自動的に設定を復元するWindows用ランチャーアプリケーションです。

## 概要

このアプリケーションは、VRChatでのIPv6接続に関する問題を回避するために開発されたランチャーです。IPv6を一時的にブロックした状態でVRChatを起動し、VRChat終了時に自動的に設定を元に戻します。

### 主な機能

- **IPv6ブロック機能**: VRChat起動前にIPv6をブロック
- **自動設定復元**: VRChat終了時に自動的にIPv6設定を復元
- **2つのブロック方式**:
  - Windowsファイアウォールによるブロック
  - ネットワークアダプタのIPv6を無効化
- **権限分離**: ランチャーは管理者権限で動作、VRChatは一般ユーザー権限で起動
- **ショートカット作成**: ランチャー経由でVRChatを起動するショートカット作成機能

## システム要件

- **OS**: Windows 10/11
- **動作確認済み**: Windows 11
- **権限**: 管理者権限が必要（IPv6設定変更のため）
- **開発環境**: Visual Studio 2022 (C++)
- **ランタイム**: 不要（WindowsAPI使用）

## インストール

1. [BOOTH](https://scrapbox.booth.pm/items/7335888)から最新版をダウンロード
2. 任意のフォルダ（例：`C:\Tools\VRCIPv6Blocker`）にファイルを配置
3. 管理者権限でアプリケーションを実行
4. 「ショートカット作成」機能を使用してランチャー用のショートカットを作成

> **注意**: インストーラーは提供されていません。手動でのファイル配置が必要です。

## 使用方法

### 初回設定

1. アプリケーションを管理者権限で起動
2. IPv6ブロック方式を選択（ファイアウォール or ネットワークアダプタ無効化）
3. 「ショートカット作成」ボタンでランチャー用ショートカットを作成

### 通常の使用

1. 作成したショートカットからVRChatを起動
2. IPv6が自動的にブロックされ、VRChatが起動します
3. VRChat終了時に設定が自動的に復元され、ランチャーも終了します

### オートモード（ショートカットから実行）

作成したショートカットから実行した場合、以下の動作となります：

- **VRChat実行**: チェックが入っていない場合、VRChatは起動せずブロック処理のみ実行されます
- **アプリ自動終了**: 「VRChat終了時にこのアプリも終了」にチェックが入っていない場合、アプリは自動終了しません（手動終了時でもブロック解除は必ず実行されます）
- **最小化**: チェックが入っていれば最小化されます
- **ボタン制限**: 設定反映、タスク削除、ショートカット作成などのボタンが無効化されます

### 通常起動（直接実行）

アプリを直接起動した場合は自動では何も実行されません。設定の変更やブロック状態の手動解除などを行う際に使用します。

### トラブルシューティング

#### アプリが異常終了してIPv6ブロック状態が残っている場合

以下の方法で解除できます：

1. **アプリから解除**: 
   - ファイアウォール方式: 「FWブロック解除」ボタンを使用
   - ネットワークアダプタ方式: 「IPv6有効化」ボタンを使用
2. **手動解除**: 
   - ファイアウォール方式: Windows Defenderファイアウォール設定から手動解除
   - アダプタ無効化方式: ネットワーク設定からIPv6を有効化

## アンインストール

1. タスクスケジューラで作成された起動用タスクを削除
2. 作成したショートカットを削除
3. インストールフォルダを削除

> **重要**: IPv6ブロック状態が残っている場合は、事前に解除するか、後で自分でファイアウォールやネットワークアダプタの設定を開いて解除・有効化してください。

## 技術仕様

- **開発言語**: C++
- **API**: Windows API（MFC等のフレームワーク不使用）
- **アーキテクチャ**: x64
- **メモリ管理**: RAII（unique_ptr使用）
- **エラーハンドリング**: 適切なエラーハンドリングによる安定動作

## 制限事項

- Windows専用（他OS未対応）
- 管理者権限必須
- VRChat以外のアプリケーションには対応していません

## ライセンス

このプロジェクトは[MITライセンス](LICENSE)の下で公開されています。

## 免責事項

**このソフトウェアの使用によって生じたいかなる損害についても、作者は一切の責任を負いません。**
自己責任でご使用ください。

## 開発者向け情報

### ビルド要件

- Visual Studio 2022
- Windows SDK
- C++20

### 開発について

- **コードの特徴**: 過去に書いたコードの流用とAI生成のコードが混在しているため、コーディングスタイルは定まっていません
- **メンテナンス性**: 機会があればリファクタリングしたいとは思っています
- **フィードバック**: バグレポートや機能要望などのフィードバックをお待ちしています

---

**⚠️ 重要な注意事項**
- このツールは管理者権限が必要です
- VRChat公式のサポート対象外のツールです
- 使用は自己責任でお願いします
